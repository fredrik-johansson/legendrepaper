from mpmath import *
from flint import arb, ctx

def clensh(f, N, I=None):
    xs = [cos(pi*k/N) for k in range(2*N+2)]
    fx = [f(xs[k]) for k in range(N+1)]
    f1 = f(mpf(1))
    fn1 = f(mpf(-1))
    def a(k):
        v = f1/2 + (-1)**k * fn1/2
        for n in range(1,N):
            v += fx[n] * xs[(n*k)%(2*N)]
        return 2*v/N
    s = a(0)
    for k in range(1, N//2):
        s += 2*a(2*k) / (1 - (2*k)**2)
    s += a(N) / (1 - N**2)
    if I is None:
        I = quad(f, [-1,1])
    return s - I

mp.dps = 1000
ctx.dps = 1000

I = mpf("1.57239266949806559075198297278478209135231172387993819069313546393443758953396973642297613604098814617137347054301950568564423437784143953198884437745463958850066838746298693743121116367225999188039745778437224356721527775098778780058196835359347901900868493176978966522723290073721765442260140089887879310539559950005889031808529424106615471409357523859689924174656147994835184657673238252910791012308069100786753213003217184671360430728995240063246077713231739446079241460198006838693324424960823832455701711152398258931166025007655286284356510603191038504006607212832774762593165004467470061268686736145526122777106666140133340996660135637161281616253060971586067494983744673906624698662874339216422262555653389520600023731245476749363887592211814621370371108413066160817506304770001995416228554114898162596946474284126931797360268771390029347960491211725589036254309986007171293083829916490396339046076547249721182317246635532646722118439474298919066925642617797525030972148714872870635023412791856194084485749502528315843639197700686261344676540411537163287340007610732800972884902590813135765869419114842682402323743664713107217253840523193880617104648177800811523870470975724255071784420478657063")
nprint(clensh(lambda x: gamma(1+1j*x), 384, I=I))

I = mpf("0.10990317364333819333679412354778428474599847954105073385203878829379756653063638802899923350903098290084544000716092300224638014883498907909937547546057918360586542802015929771412842672793896412651154877388183163187749381201110304596029598068840079719994820587716417997769733215720194885772488875417932147835404272225778303818962923684370056841150538028772951375462244933214536295145531084365176443776486676351535997642529430579371872216283291598287525272042617476846433468682148951903566637658293851754737801011119019162275127454432182631765432267748173425851255992132423475567929072633263742734845842276918217159364133165355168570493428995229209085852419126876888871376665686942983220517100227411698708452503609940208631578244381606423328810877071411807925895716108143834636019373295465493569894268921520321195392834866522818779193384033150976179363433593935378938110641049936027823447608014746852226229433683825915803439741613598966991065510411914080495661160745803784953047805643683571543228900105332339572465588026252979000187988555465644352567604295538355301635939443229838264248794469171429981231388851167778351752122785408885847085519220934635677105282815636327923794647435105886331453250882348880611176955516100177606258423516911454806476403256001290371362487214192705664950702887631953984962346391844450983915682320636646379664651210824968646372509052689791599418031105995623107445261096849420676909604518164738242363482685184669375156867170110478007201914411897820640561291858825709444063")

nprint(clensh(lambda x: arb(10*x).airy_ai(), 384, I=I))

